<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Búsqueda Binaria — Demo</title>
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; padding: 20px; max-width: 900px; margin: auto; }
    h1 { margin-bottom: 8px; }
    label { display:block; margin-top:10px; font-weight:600; }
    textarea { width:100%; height:70px; font-family: monospace; padding:8px; }
    input[type="text"], input[type="number"] { width:100%; padding:8px; }
    .row { display:flex; gap:10px; margin-top:10px; }
    .col { flex:1; }
    button { margin-top:10px; padding:10px 14px; border-radius:6px; cursor:pointer; }
    .output { margin-top:12px; padding:12px; border-radius:8px; background:#f6f6f6; min-height:36px;}
    .steps { margin-top:12px; max-height:240px; overflow:auto; padding:10px; background:#fff; border:1px solid #eee; border-radius:6px; }
    .step { font-family: monospace; padding:4px 0; border-bottom:1px dashed #eee; }
    small.note { color:#666; display:block; margin-top:6px; }
  </style>
</head>
<body>
  <h1>Búsqueda Binaria (Binary Search)</h1>
  <p>Busca un elemento en un array <strong>ordenado</strong> dividiendo la búsqueda a la mitad cada paso. Complejidad: <code>O(log n)</code>.</p>

  <label for="arr">Array (separa con comas o espacios)</label>
  <textarea id="arr" placeholder="ej: 1, 3, 4, 7, 10"></textarea>

  <div class="row">
    <div class="col">
      <label for="target">Valor a buscar</label>
      <input id="target" type="text" placeholder="ej: 7" />
    </div>
    <div style="width:160px;">
      <label>&nbsp;</label>
      <div style="display:flex; gap:8px; align-items:center;">
        <input id="autoSort" type="checkbox" checked />
        <label for="autoSort" style="font-weight:normal; margin:0;">Ordenar</label>
      </div>
    </div>
  </div>

  <div class="row">
    <button id="run">Buscar</button>
    <button id="example">Cargar ejemplo</button>
    <button id="clearSteps">Limpiar pasos</button>
  </div>

  <div class="output" id="result">Resultado: —</div>

  <div>
    <label>Pasos del algoritmo</label>
    <div class="steps" id="steps"></div>
    <small class="note">Nota: si eliges "Ordenar", el índice devuelto corresponde al array ordenado.</small>
  </div>

  <script>
   
    function parseInputArray(text) {
      
      const parts = text.split(/[\s,]+/).filter(Boolean);
      
      const allNumbers = parts.length > 0 && parts.every(p => !isNaN(p));
      return { parts, allNumbers };
    }

    
   
    function binarySearch(arr, target, numeric = false, onStep = null) {
      let low = 0;
      let high = arr.length - 1;

      while (low <= high) {
        const mid = Math.floor((low + high) / 2);
        const midVal = arr[mid];

        if (onStep) onStep({ low, mid, high, midVal });

       
        let cmp;
        if (numeric) {
          const a = Number(midVal);
          const b = Number(target);
          cmp = (a === b) ? 0 : (a < b ? -1 : 1);
        } else {
         
          const a = String(midVal);
          const b = String(target);
          cmp = (a === b) ? 0 : (a < b ? -1 : 1);
        }

        if (cmp === 0) return mid;       
        if (cmp < 0) low = mid + 1;       
        else high = mid - 1;              
      }
      return -1; 
    }

   
    const arrEl = document.getElementById('arr');
    const targetEl = document.getElementById('target');
    const runBtn = document.getElementById('run');
    const resultEl = document.getElementById('result');
    const stepsEl = document.getElementById('steps');
    const autoSortEl = document.getElementById('autoSort');
    const exampleBtn = document.getElementById('example');
    const clearStepsBtn = document.getElementById('clearSteps');

    function addStep(step) {
      const div = document.createElement('div');
      div.className = 'step';
      div.textContent = `low=${step.low}  mid=${step.mid}  high=${step.high}  midVal=${step.midVal}`;
      stepsEl.appendChild(div);
      stepsEl.scrollTop = stepsEl.scrollHeight;
    }

    runBtn.addEventListener('click', () => {
      stepsEl.innerHTML = '';
      resultEl.textContent = 'Resultado: buscando...';

      const raw = arrEl.value.trim();
      if (!raw) { resultEl.textContent = 'Resultado: introduce un array.'; return; }

      const targetRaw = targetEl.value;
      if (targetRaw === '') { resultEl.textContent = 'Resultado: introduce el valor a buscar.'; return; }

      const parsed = parseInputArray(raw);
      let items = parsed.parts.slice(); 
      const numeric = parsed.allNumbers && !isNaN(targetRaw);

      
      if (autoSortEl.checked) {
        if (numeric) {
          items.sort((a,b) => Number(a) - Number(b));
        } else {
          items.sort(); 
        }
      }

     
      const displayArray = items.join(', ');
      const usedArrayLine = document.createElement('div');
      usedArrayLine.style.marginBottom = '8px';
      usedArrayLine.textContent = `Array usado: [ ${displayArray} ]`;
      stepsEl.appendChild(usedArrayLine);

   
      const index = binarySearch(items, targetRaw, numeric, addStep);

      if (index >= 0) {
        resultEl.textContent = `Resultado: elemento encontrado en índice ${index} (del array mostrado).`;
      } else {
        resultEl.textContent = 'Resultado: elemento NO encontrado.';
      }
    });

    exampleBtn.addEventListener('click', () => {
      arrEl.value = '2, 3, 5, 7, 11, 13, 17';
      targetEl.value = '11';
      autoSortEl.checked = true;
    });

    clearStepsBtn.addEventListener('click', () => {
      stepsEl.innerHTML = '';
    });

 
    exampleBtn.click();
  </script>
</body>
</html>
